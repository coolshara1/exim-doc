
.. _ch14_00:

Главная конфигурация
====================

Первая часть файла рабочей конфигурации содержит три типа элементов:

* Макроопределения: Эти строки начинаются с символа в верхнем регистре. Смотрите раздел :ref:`6.4 <ch06_04>` для получения дополнительных деталей о макрообработке.
* Определения именованных списков: Эти строки начинаются с одного из слов **domainlist**, **hostlist**, **addresslist**, или **localpartlist**. Их использование описано в разделе :ref:`10.5 <ch10_05>`.
* Главные конфигурационные настройки: Каждая установка занимает одну строку файла (с возможностью продолжения). Если какой-либо установке предшествует слово **hide**, опция командной строки **-bP** отображает её значение лишь административным пользователям. Смотрите раздел :ref:`6.10 <ch06_10>` для описания синтаксиса этих параметров настройки.

Эта глава определяет все главные конфигурационные опции, наряду с их типами и дефолтовыми значениями. Для простоты нахождения специфической опции, они перечислены в алфавитном порядке ниже, в разделе :ref:`14.23 <ch14_23>`. Однако, поскольку сейчас тут очень много опций, они, вначале, кратко перечислены в функциональных группах, как помощь, для нахождения имени опции, которую вы ищете. Некоторые опции перечислены более чем в одной группе.

.. _ch14_01:

Разное
------
=========================  ======================
**bi_command**             запускается при опции командной строки **-bi**
**disable_ipv6**           не обрабатывать IPv6
**keep_malformed**         для повреждённых файлов - должно не случаться
**localhost_number**       для уникальных идентификаторов сообщений, в кластерах
**message_body_newlines**  сохранять число переводов строки в ``$message_body``
**message_body_visible**   как много показывать в ``$message_body``
**mua_wrapper**            работать в режиме **MUA wrapper**
**print_topbitchars**      печатать  символы верхних битов
**timezone**               принудительная установка часового пояса
=========================  ======================

.. _ch14_02:

Параметры Exim
--------------

=========================  ====================== 
**exim_group**             переопределяет вкомпиленное значение
**exim_path**              переопределяет вкомпиленное значение
**exim_user**              переопределяет вкомпиленное значение
**primary_hostname**       дефолт из *uname()*
**split_spool_directory**  использовать много директорий
**spool_directory**        переопределяет вкомпиленное значение
=========================  ======================


.. _ch14_03:

Настройки привелегий
--------------------

=============================  =====================
**admin_groups**               список административных групп
**deliver_drop_privilege**     отказ от root`овых прав при доставке
**local_from_check**           вставлять “Sender:”, если необходимо
**local_from_prefix**          для проверки “From:”, для локального отправителя
**local_from_suffix**          для проверки “From:”, для локального отправителя
**local_sender_retain**        оставлять “Sender:”, для недоверенных пользователей
**never_users**                не запускать доставки под этими пользователями
**prod_requires_admin**        принудительная доставка требует административного пользователя
**queue_list_requires_admin**  листинг очереди требует административного пользователя
**trusted_groups**             группы, которым доверяют
**trusted_users**              пользователи, которым доверяют
=============================  =====================

.. _ch14_04:

Логгинг
-------

==========================  =========
**hosts_connection_nolog**  не логгировать соединения
**log_file_path**           переопределяет вкомпиленные значения
**log_selector**            установить/сбросить опциональный логгинг
**log_timezone**            добавлять в строки логов временную зону
**message_logs**            создавать логи для каждого сообщения
**preserve_message_logs**   оставлять логи каждого сообщения после обработки
**process_log_path**        для ``SIGUSR1`` и *exiwhat*
**syslog_duplication**      контролировать повторяющиеся строки логов в syslog
**syslog_facility**         установка поля “facility” в syslog
**syslog_processname**      установка поля “ident” в syslog
**syslog_timestamp**        временная метка в строках syslog
**write_rejectlog**         контролирует использование лога сообщений
==========================  =========

.. _ch14_05:

Замороженные сообщения
----------------------

========================  ==========
**auto_thaw**             устанавливает время повтора, для замороженного сообщения
**freeze_tell**           посылка сообщения, когда происходит заморозка
**move_frozen_messages**  в другую директорию
**timeout_frozen_after**  как долго хранить замороженные сообщения
========================  ==========

.. _ch14_06:

Поиск данных
------------

========================  =========
**ibase_servers**         сервера InterBase
**ldap_default_servers**  используется, если нет сервера в запросе
**ldap_version**          устанавливает версию протокола
**lookup_open_max**       сколько файлов держать открытыми
**mysql_servers**         список MySQL-серверов по умолчанию
**oracle_servers**        сервера Oracle
**pgsql_servers**         список PostgreSQL-серверов по умолчанию
**sqlite_lock_timeout**   смысл соответствует названию опции
========================  =========

.. _ch14_07:

Идентификаторы сообщений
------------------------

============================  =========
**message_id_header_domain**  используется для построения заголовка “Message-ID:”
**message_id_header_text**    смысл соответствует названию опции
============================  =========

.. _ch14_08:

Запуск встроенного Perl`a
-------------------------

=================  ===========
**perl_at_start**  всегда запускать интерпретатор
**perl_startup**   код для выполнения, при запуске Perl
=================  ===========


.. _ch14_09:

Даемон
------

==========================  ==============
**daemon_smtp_ports**       дефолтовые порты
**daemon_startup_retries**  число повторов при неудачном запуске
**daemon_startup_sleep**    время ожидания между повторными запусками
**extra_local_interfaces**  какие интерфейсы необязательно слушать
**local_interfaces**        какие интерфейсы слушать, с опциональным номером порта
**pid_file_path**           перезадаёт вкомпиленное значение
**queue_run_max**           максимальное число одновременных обработчиков очереди
==========================  ==============


.. _ch14_10:

Контроль ресурсов
-----------------

====================================  ============================================
**check_log_inodes**                  до приёма сообщения
**check_log_space**                   до приёма сообщения
**check_spool_inodes**                до приёма сообщения
**check_spool_space**                 до приёма сообщения
**deliver_queue_load_max**            не обрабатывать очередь при высокой загрузке
**queue_only_load**                   при высокой загрузке, входящие сообщения, только класть в очередь
**queue_only_load_latch**             не переоценивать нагрузку, для каждого сообщения
**queue_run_max**                     максимальное число одновременных обработчиков очереди
**remote_max_parallel**               параллельных SMTP доставок, на сообщение
**smtp_accept_max**                   одновременных входящих соединений
**smtp_accept_max_nonmail**           не-почтовых команд
**smtp_accept_max_nonmail_hosts**     хосты к которым применяются ограничения
**smtp_accept_max_per_connection**    сообщений за соединение
**smtp_accept_max_per_host**          соединений с одного хоста
**smtp_accept_queue**                 при большом числе соединений, класть сообщения в очередь, не доставлять
**smtp_accept_queue_per_connection**  класть в очередь, при большом числе сообщений за одно соединение
**smtp_accept_reserve**               принимать только от зарезервированных хостов, если много соединений
**smtp_check_spool_space**            проверять свободное место, исходя из SIZE в команде MAIL
**smtp_connect_backlog**              передаётся стеку TCP/IP
**smtp_load_reserve**                 SMTP с зарезервированных хостов, при высокой загрузке
**smtp_reserve_hosts**                список зарезервированных хостов
====================================  ============================================

.. _ch14_11:

Управление политиками
---------------------

==========================  =======================
**acl_not_smtp**            ACL для не-SMTP сообщений
**acl_not_smtp_mime**       ACL для не-SMTP частей MIME
**acl_not_smtp_start**      ACL для запуска не-SMTP сообщений
**acl_smtp_auth**           ACL для AUTH
**acl_smtp_connect**        ACL для соединений
**acl_smtp_data**           ACL для DATA
**acl_smtp_etrn**           ACL для ERTN
**acl_smtp_expn**           ACL для EXPN
**acl_smtp_helo**           ACL для HELO или EHLO
**acl_smtp_mail**           ACL для MAIL
**acl_smtp_mailauth**       ACL для команды AUTH в команде MAIL
**acl_smtp_mime**           ACL для чaстей MIME
**acl_smtp_predata**        ACL для начала данных
**acl_smtp_quit**           ACL для QUIT
**acl_smtp_rcpt**           ACL для RCPT
**acl_smtp_starttls**       ACL для STARTTLS
**acl_smtp_vrfy**           ACL для VRFY
**av_scanner**              определяет сканер вирусов
**check_rfc2047_length**    проверяет, длинну “закодированных слов” (по :rfc:`2047`)
**dns_csa_search_limit**    контролирует вложенность поисков CSA
**dns_csa_use_reverse**     включение/выключение реверсивных поисков IP CSA
**header_maxsize**          полный размер заголовка сообщения
**header_line_maxsize**     ограничения строки одного заголовка
**helo_accept_junk_hosts**  позволить синтаксические ошибки для этих хостов
**helo_allow_chars**        разрешить неправильные символы в HELO
**helo_lookup_domains**     искать имя хоста для этих имён в HELO
**helo_try_verify_hosts**   мягкая проверка HELO для этих хостов
**helo_verify_hosts**       жёсткая проверка HELO для этих хостов
**host_lookup**             искать имя хоста [#]_ для этих хостов
**host_lookup_order**       порядок поиска имён в DNS и локально
**host_reject_connection**  отклонить соединения с этих хостов
**hosts_treat_as_local**    полезно для некоторых кластерных конфигураций
**local_scan_timeout**      таймаут для *local_scan()*
**message_size_limit**      для всех сообщений
**percent_hack_domains**    распознавать %-хак, для этих доменов
**spamd_address**           указать интерфейс к SpamAssassin
**strict_acl_vars**         объект для отключения переменных ACL
==========================  =======================

.. _ch14_12:

Кэш обратных вызовов
--------------------

==================================  ========================
**callout_domain_negative_expire**  таймаут для элементов негативного кэша доменов
**callout_domain_positive_expire**  таймаут для элементов позитивного кэша доменов
**callout_negative_expire**         таймаут для элементов негативного кэша адресов
**callout_positive_expire**         таймаут для элементов позитивного кэша адресов
**callout_random_local_part**       строка используемая для “случайного” тестирования
==================================  ========================

.. _ch14_13:

TLS
---

============================  ==========
**gnutls_require_kx**         контроль обмена ключей GnuTLS
**gnutls_require_mac**        контроль алгоритмов GnuTLS MAC
**gnutls_require_protocols**  протоколы GnuTLS
**gnutls_compat_mode**        использовать GnuTLS в совместимом режиме
**tls_advertise_hosts**       информировать о TLS эти хосты
**tls_certificate**           расположение сертификата сервера
**tls_crl**                   список аннулированых сертификатов
**tls_dhparam**               параметры DH для сервера
**tls_on_connect_ports**      задание порта SSMTP (SMTPS)
**tls_privatekey**            расположение приватного ключа сервера
**tls_remember_esmtp**        не сбрасывать после начала TLS
**tls_require_ciphers**       определить разрешённые шифры
**tls_try_verify_hosts**      пробовать проверить сертификаты клиента
**tls_verify_certificates**   ожидаемые сертификаты клиентов
**tls_verify_hosts**          обязательная проверка сертификатов клиента
============================  ==========


.. _ch14_14:

Локальная обработка пользователей
---------------------------------

=======================  ========
**finduser_retries**     полезна в окружении NIS
**gecos_name**           используется при создании “Sender:”
**gecos_pattern**        смысл соответствует названию опции
**max_username_length**  для систем, укорачивающих имена
**unknown_login**        используется, когда не найден логин
**unknown_username**     смысл соответствует названию опции
**uucp_from_pattern**    для распознания строк “From ”
**uucp_from_sender**     смысл соответствует названию опции
=======================  ========

.. _ch14_15:

Все входящие сообщения (SMTP и не-SMTP)
---------------------------------------

=========================  =============
**header_maxsize**         полный размер заголовка сообщения
**header_line_maxsize**    ограничение отдельной строки заголовка
**message_size_limit**     применяется ко всем сообщениям
**percent_hack_domains**   распознавать %-хак для этих доменов
**received_header_text**   раскрывать для создания “Received:”
**received_headers_max**   для детектирования зациклиания почты
**recipients_max**         ограничение на сообщение
**recipients_max_reject**  отклонять сообщения у которых слишком много
=========================  =============

.. _ch14_16:

Входящие не-SMTP сообщения
--------------------------

===============  =====
receive_timeout  для не-SMTP сообщений
===============  =====

.. _ch14_17:

Входящие SMTP сообщения
-----------------------

Также смотрите выше, раздел “Управление политиками”.

====================================  =============
**host_lookup**                       поиск имени хоста для этих хостов
**host_lookup_order**                 порядок поиска имени в DNS и локально
**recipient_unqualified_hosts**       может слать с неквалифицированным получателем
**rfc1413_hosts**                     создаёт вызов ident к этим хостам
**rfc1413_query_timeout**             ноль - отключает вызовы ident
**sender_unqualified_hosts**          может слать с неквалифицированным отправителем
**smtp_accept_keepalive**             немного магии TCP/IP
**smtp_accept_max**                   одновременных входящих соединений
**smtp_accept_max_nonmail**           не-почтовых команд
**smtp_accept_max_nonmail_hosts**     хосты к которым применяются ограничения
**smtp_accept_max_per_connection**    сообщений через соединение
**smtp_accept_max_per_host**          соединений с одного хоста
**smtp_accept_queue**                 оставлять в очереди, если много соединений
**smtp_accept_queue_per_connection**  оставлять в очереди, если много сообщений в соединении
**smtp_accept_reserve**               только зарезервированные хосты, если много соединений
**smtp_active_hostname**              имя хоста для использования в сообщении
**smtp_banner**                       текст для приветственного баннера
**smtp_check_spool_space**            из SIZE в команде MAIL
**smtp_connect_backlog**              передаётся стеку TCP/IP
**smtp_enforce_sync**                 синхронизация SMTP команд/ответов
**smtp_etrn_command**                 что запускать для ETRN
**smtp_etrn_serialize**               лишь один одновременно
**smtp_load_reserve**                 только зарезервированные хосты, если такая загрузка
**smtp_max_unknown_commands**         до разрыва соединения
**smtp_ratelimit_hosts**              применять ограничения частоты для этих хостов
**smtp_ratelimit_mail**               ограничения частоты для команд MAIL
**smtp_ratelimit_rcpt**               ограничения частоты для команд RCPT
**smtp_receive_timeout**              для команды, или строки данных
**smtp_reserve_hosts**                список зарезервированных хостов
**smtp_return_error_details**         выдавать детали о отклонении
====================================  =============

.. _ch14_18:

Расширения SMTP
---------------

==============================  ============
**accept_8bitmime**             информировать о 8BITMIME
**auth_advertise_hosts**        информировать эти хосты о AUTH
**ignore_fromline_hosts**       разрешить “From ”, для этих хостов
**ignore_fromline_local**       разрешить “From ”, для локальных SMTP
**pipelining_advertise_hosts**  информировать эти хосты о конвейерной обработке
**tls_advertise_hosts**         информировать эти хосты о TLS
==============================  ============


.. _ch14_19:

Обработка сообщений
-------------------

======================================  =======
**allow_domain_literals**               распознавать синтаксис доменных литералов
**allow_mx_to_ip**                      разрешить MX указывать на IP-адрес
**allow_utf8_domains**                  в адресе
**check_rfc2047_length**                проверяет, длинну “закодированных слов” (по :rfc:`2047`)
**delivery_date_remove**                из входящих сообщений
**envelope_to_remote**                  из входящих сообщений
**extract_addresses_remove_arguments**  затрагивает обработку **-t**
**headers_charset**                     значение по умолчанию для переводов
**qualify_domain**                      значение по умолчанию для  отправителей
**qualify_recipient**                   значение по умолчанию для получателей
**return_path_remove**                  из входящих сообщений
**strip_excess_angle_brackets**         в адресах
**strip_trailing_dot**                  в конце адресов
**untrusted_set_sender**                недоверенные могут устанавливать отправителя конверта
======================================  =======


.. _ch14_20:

Системный фильтр
----------------

=====================================  =============
**system_filter**                      расположение системного фильтра
**system_filter_directory_transport**  транспорт для доставки в директорию
**system_filter_file_transport**       транспорт для доставки в файл
**system_filter_group**                группа, от которой работает фильтр
**system_filter_pipe_transport**       транспорт для доставки в трубу
**system_filter_reply_transport**      транспорт для доставки автоответа
**system_filter_user**                 пользователь, от которого работает системный фильтр
=====================================  =============


.. _ch14_21:

Роутинг и доставка
------------------

============================  ==============
**disable_ipv6**              не обрабатывать IPv6
**dns_again_means_nonexist**  для битых доменов
**dns_check_names_pattern**   предварительная синтаксическая проверка DNS
**dns_ipv4_lookup**           для этих доменов, поиск только v4
**dns_retrans**               параметр для резольвера
**dns_retry**                 параметр для резольвера
**hold_domains**              задержать доставку для этих доменов
**local_interfaces**          для проверок роутинга
**queue_domains**             нет немедленной доставки для этих доменов
**queue_only**                нет немедленной доставки для всех
**queue_only_file**           нет немедленной доставки, если файл существует
**queue_only_load**           нет немедленной доставки, если высокая загрузка
**queue_only_load_latch**     не пересчитывать нагрузку для каждого сообщения
**queue_only_override**       позволить отменять с командной строки
**queue_run_in_order**        порядок доставки
**queue_run_max**             одновременных обработчиков очереди
**queue_smtp_domains**        нет немедленной SMTP доставки для этих доменов
**remote_max_parallel**       параллельных SMTP доставок на сообщение
**remote_sort_domains**       порядок удалённых доставок
**retry_data_expire**         таймаут для данных повторов
**retry_interval_max**        безопасная сеть для правил повторов
============================  ==============

.. _ch14_22:

Рикошеты и предупрждающие сообщения
-----------------------------------

================================  ===============
**bounce_message_file**           содержимое рикошета
**bounce_message_text**           содержимое рикошета
**bounce_return_body**            включать тело, если сообщение возвращается
**bounce_return_message**         включать оригинальное сообщение в рикошет
**bounce_return_size_limit**      ограничение на возвращаемые сообщения
**bounce_sender_authentication**  посылать аутентифицированному отправителю с рикошетом
**dsn_from**                      установка содержимого заголовка “From:” в рикошете
**errors_copy**                   копировать рикошеты
**errors_reply_to**               “Reply-to:” в рикошетах
**delay_warning**                 планирование времени
**delay_warning_condition**       условие для предупреждающих сообщений
**ignore_bounce_errors_after**    уничтожать недоставленные рикошеты
**smtp_return_error_details**     выдывать детали при отклонении
**warn_message_file**             содержимое предупреждающего сообщения
================================  ===============


.. _ch14_23:

Алфавитный список главных опций
-------------------------------
Те опции, которые подвергаются раскрытию строки, до использования, помечены символом **†**.

===================  =========  =============  ==============
**accept_8bitmime**  Use: main  Type: boolean  Default: false
===================  =========  =============  ==============

Эта опция заставляет exim посылать 8BITMIME в его ответе на команду SMTP EHLO, и принимать параметр BODY= в командах MAIL. Однако, хотя exim чисто 8-битовый, он не конвертер протоколов, и не принимает каких-либо специальных действий для сообщений полученных в соответствии с этим маршрутом. Следовательно, по умолчанию эта опция отключена.

.. [#] в DNS - прим. lissyara
