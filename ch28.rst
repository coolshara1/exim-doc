
.. _ch28_00:

Транспорт **lmtp**
==================

Транспорт **lmtp** выполняет протокол LMTP (:rfc:`2033`) через трубу (pipe) к указанной команде, или взаимодействуя с сокетом UNIX. Этот транспорт - нечто среднее между транспортами **pipe** и **smtp**. Также exim поддерживает LMTP через TCP/IP, эта функция реализована в виде опции транспорта **smtp**. Поскольку, ожидается, что LMTP будет не очень интересен, в дефолтовом скрипте *configure*, в *src/EDITME* он закомментрован. Вы должны гарантировать, что

::

    TRANSPORT_LMTP=yes

присутствует в вашем *Local/Makefile*, для включения транспорта **lmtp** в бинарник Exim`a. Частные опции транспорта **lmtp** таковы:

============  =========  =============  ==============
**batch_id**  Use: lmtp  Type: string†  Default: unset
============  =========  =============  ==============

Смотрите описание пакетной локальной доставки в главе :ref:`25 <ch25_00>`.

=============  =========  =============  ==========
**batch_max**  Use: lmtp  Type: integer  Default: 1
=============  =========  =============  ==========

Эта опция ограничивает число адресов, которые могут быть обработаны в одной доставке. Большинство серверов LMTP могут обрабатывать сразу несколько адресов, таким образом, обычно, увеличение этого числа - хорошая идея. Смотрите описание пакетной локальной доставки в главе :ref:`25 <ch25_00>`.

===========  =========  =============  ==============
**command**  Use: lmtp  Type: string†  Default: unset
===========  =========  =============  ==============

Эта опция должна быть задана, если не задана опция **socket**. Строка - команда, которая запускается в отдельном процессе. Она разделяется на имя команды и список аргументов, каждый из которых отдельно раскрывается (таким образом, раскрытие не может изменить число аргументов). Команда выполняется напрямую, не через shell. Сообщение передаётся новому процессу, используя стандартный ввод и вывод для управления протоколом LMTP.

================  =========  =============  ==============
**ignore_quota**  Use: lmtp  Type: boolean  Default: false
================  =========  =============  ==============

Если эта опция установлена в истину, в команды RCPT добавляется строка ``IGNOREQUOTA``, при условии что сервер LMTP информировал о поддержке ``IGNOREQUOTA`` в его ответе на команду LHLO.

==========  =========  =============  ==============
**socket**  Use: lmtp  Type: string†  Default: unset
==========  =========  =============  ==============

Эта опция должна быть задана, если не задана опция **command**. Результат раскрытия должен быть именем UNIX-сокета. Транспорт соединяется с сокетом и доставляет в него сообщение, используя протокол LMTP.

===========  =========  ==========  ===========
**timeout**  Use: lmtp  Type: time  Default: 5m
===========  =========  ==========  ===========

Транспорт прекращает свою работу, если созданный процесс или Unix сокет не отвечает на команды LMTP, или происходит этот таймаут при передаче сообщения. Доставка задерживается, и будет попробована позднее. Это - пример типичного транспорта LMTP::

    lmtp:
      driver = lmtp
      command = /some/local/lmtp/delivery/program
      batch_max = 20
      user = exim
      
Он доставялет до 20 адресов одновременно, если необходимо, в смешанные домены, работая как пользователь *exim*.
           
