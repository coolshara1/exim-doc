
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Группировка адресов в локальных транспортах &mdash; Specification of the Exim Mail Transfer Agent 4.70 documentation</title>
    
    <link rel="stylesheet" href="static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '4.70',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/translations.js"></script>
    <link rel="top" title="Specification of the Exim Mail Transfer Agent 4.70 documentation" href="index.html" />
    <link rel="next" title="Транспорт appendfile" href="ch26.html" />
    <link rel="prev" title="Общие параметры для транспортов" href="ch24.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="static/small_flask.css" type= "text/css" rel="stylesheet" />

  </head>
  <body>
    <div class="related">
      <h3>Просмотр</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Словарь-указатель"
             accesskey="I">словарь</a></li>
        <li class="right" >
          <a href="ch26.html" title="Транспорт appendfile"
             accesskey="N">следующий</a> |</li>
        <li class="right" >
          <a href="ch24.html" title="Общие параметры для транспортов"
             accesskey="P">предыдущий</a> |</li>
        <li><a href="index.html">Specification of the Exim Mail Transfer Agent 4.70 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ch25-00">
<span id="id1"></span><h1>Группировка адресов в локальных транспортах<a class="headerlink" href="#ch25-00" title="Ссылка на этот заголовок">¶</a></h1>
<p>Обычно, лишь удалённый транспорт (<strong>smtp</strong>) сконфигурирован для обработки более одного адреса за раз, таким образом, чтобы когда несколько адресов маршрутизируются к одному хосту, посылалась лишь одна копия сообщения. Однако, локальные транспорты, обычно, обрабатывают одновременно лишь один адрес. Таким образом, транспортировка выполняется для каждого адреса, направленного транспорту. Единовременно доставляется лишь одна копия сообщения.</p>
<ul class="simple">
<li>В транспорте <strong>appendfile</strong>, когда сообщение сохраняется в файл для дальнейшей доставки какими-то другими средствами, сохраняется одна копия сообщения с несколькими адресатами, для экономии места.</li>
<li>В транспорте <strong>lmtp</strong>, при доставке через “локальный SMTP” другим процессам, сохраняется время, путём доставки одной копии сообщения, и это обычно ожидаемый способ работы LMTP.</li>
<li>В транспорте <strong>pipe</strong>, при передаче сообщения сканирущей программе, или иному доставляющему механизму, типа UUCP, могут быть приемлимы несколько получателей.</li>
</ul>
<p>Эти три локальных транспорта имеют те же самые параметры для контроля многочисленных (“batched” - пакетных) доставок, именуемых <strong>batch_max</strong> и <strong>batch_id</strong>. Для сохранения повторения информации для каждого транспорта, эти параметры описаны тут.</p>
<p>Параметр <strong>batch_max</strong> определяет максимальное число адресов, которые могут быть доставлены вместе, в одном запуске транспорта. Его значение по умолчанию - единица (нет пакетной передачи). Когда более одного адреса маршрутизируется на транспорт, имеющий значение <strong>batch_max</strong> больше единицы, адреса доставляются пакетно (т.е. в одном запуске транспорта, с многочисленными получателями), подчиняясь определённым условиям:</p>
<ul class="simple">
<li>Если любой параметр транспорта содержит ссылку на $local_part - пакетная передача невозможна.</li>
<li>Если любой параметр транспорта содержит ссылку на $domain, передаются пакетно лишь те адреса, у которых одинаковый домен.</li>
<li>Если <strong>batch_id</strong> установлена, она раскрывается для каждого адреса, и передаются пакетно лишь те адреса, у которых, в результате раскрытия, одинаковое значение. Это позволяет задавать ручные настройки пакетной передачи. Ошибка раскрытия, в любом случае, включая принудительную неудачу, отключает пакетную передачу, но не останавливает доставку.</li>
<li>Пакетные адреса также должны иметь одинаковый обратный адрес (для возврата ошибок доставки), одинаквые добавления и удаления заголовков, одного и того же пользователя и группу для транспорта, и если представлен список хостов, первый хост должен быть тем самым хостом.</li>
</ul>
<p>В случае транспортов <strong>appendfile</strong> и <strong>pipe</strong>, пакетная передача применяется к ним обоим, когда файл или команда трубы (pipe command) задана в транспорте, и когда это определено маршрутизатором <strong>redirect</strong>, но, разумеется, все пакетные адреса должны быть направлены в один и тот же файл или команду трубы. Эти два транспорта имеют параметр называемый <strong>use_bsmtp</strong>, заставляющую их доставлять сообщение в формате “пакетного SMTP”, с конвертом представленным в команде SMTP. Параметры <strong>check_string</strong> и <strong>escape_string</strong> приводятся к значениям</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">check_string</span> <span class="o">=</span> <span class="s">&quot;.&quot;</span>
<span class="n">escape_string</span> <span class="o">=</span> <span class="s">&quot;..&quot;</span>
</pre></div>
</div>
<p>когда используется пакетная SMTP-передача. Полное описание механизма пакетного SMTP дано в разделе <a class="reference internal" href="ch45.html#ch45-10"><em>45.10</em></a>. Транспорт <strong>lmtp</strong> не имеет параметра <strong>use_bsmtp</strong>, поскольку он всегда доставляет используя SMTP-протокол.</p>
<p>Общий параметр <strong>envelope_to_add</strong> установлена для пакетного транспорта, заголовок “Envelope-to:”, добавляющийся к сообщению, содержит все адреса, которые обрабатываются вместе. Если вы используете пакетный транспорт <strong>appendfile</strong> без <strong>use_bsmtp</strong>, единственный способ сохранить адрес получателя - установить параметр <strong>envelope_to_add</strong>.</p>
<p>Если вы используете транспорт <strong>pipe</strong> без BSMTP, и устанавливаете транспортный параметр <strong>command</strong>, вы должны включить $pipe_addresses как часть команды. Это не истинная переменная, это немного шаманства, позволяющего подставить адреса получателей как раздельные аргументы. Этим предоставляется способ обратиться ко всем адресам, доставляемым в пакете.</p>
<div class="admonition note">
<p class="first admonition-title">Примечание</p>
<p class="last">Это невозможно для команды трубы, заданной путём маршрутизатора <strong>redirect</strong>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ch24.html" title="предыдущая глава">Общие параметры для транспортов</a></li>
      <li>Next: <a href="ch26.html" title="следующая глава">Транспорт <strong>appendfile</strong></a></li>
  </ul></li>
</ul>
  <h3>На этой странице</h3>
  <ul class="this-page-menu">
    <li><a href="sources/ch25.txt"
           rel="nofollow">Показать исходный текст</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Быстрый поиск</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Искать" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Введите слова для поиска или имя модуля, класса или функции.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; Copyright 2011, Exim Maintainers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </div>
  </body>
</html>